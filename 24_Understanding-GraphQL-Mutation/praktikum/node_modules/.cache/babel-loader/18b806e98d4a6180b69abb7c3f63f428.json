{"ast":null,"code":"import _typeof from \"C:/Users/Asus X441M/Documents/ALTERRA/vue-js_ilmy-rahmawaty/23_Understanding-GraphQL-Query/belajar/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport { ApolloLink, Observable } from 'apollo-link';\n\nvar sha256 = require('hash.js/lib/hash/sha/256');\n\nimport { print } from 'graphql/language/printer';\nexport var VERSION = 1;\nexport var defaultGenerateHash = function defaultGenerateHash(query) {\n  return sha256().update(print(query)).digest('hex');\n};\nexport var defaultOptions = {\n  generateHash: defaultGenerateHash,\n  disable: function disable(_a) {\n    var graphQLErrors = _a.graphQLErrors,\n        operation = _a.operation;\n\n    if (graphQLErrors && graphQLErrors.some(function (_a) {\n      var message = _a.message;\n      return message === 'PersistedQueryNotSupported';\n    })) {\n      return true;\n    }\n\n    var response = operation.getContext().response;\n\n    if (response && response.status && (response.status === 400 || response.status === 500)) {\n      return true;\n    }\n\n    return false;\n  },\n  useGETForHashedQueries: false\n};\n\nfunction definitionIsMutation(d) {\n  return d.kind === 'OperationDefinition' && d.operation === 'mutation';\n}\n\nfunction operationIsQuery(operation) {\n  return !operation.query.definitions.some(definitionIsMutation);\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar hashesKeyString = '__createPersistedQueryLink_hashes';\nvar hashesKey = typeof Symbol === 'function' ? Symbol.for(hashesKeyString) : hashesKeyString;\nvar nextHashesChildKey = 0;\nexport var createPersistedQueryLink = function createPersistedQueryLink(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _a = Object.assign({}, defaultOptions, options),\n      generateHash = _a.generateHash,\n      disable = _a.disable,\n      useGETForHashedQueries = _a.useGETForHashedQueries;\n\n  var supportsPersistedQueries = true;\n  var hashesChildKey = 'forLink' + nextHashesChildKey++;\n\n  function getQueryHash(query) {\n    if (!query || _typeof(query) !== 'object') {\n      return generateHash(query);\n    }\n\n    if (!hasOwnProperty.call(query, hashesKey)) {\n      Object.defineProperty(query, hashesKey, {\n        value: Object.create(null),\n        enumerable: false\n      });\n    }\n\n    var hashes = query[hashesKey];\n    return hasOwnProperty.call(hashes, hashesChildKey) ? hashes[hashesChildKey] : hashes[hashesChildKey] = generateHash(query);\n  }\n\n  return new ApolloLink(function (operation, forward) {\n    if (!forward) {\n      throw new Error('PersistedQueryLink cannot be the last link in the chain.');\n    }\n\n    var query = operation.query;\n    var hashError;\n\n    if (supportsPersistedQueries) {\n      try {\n        operation.extensions.persistedQuery = {\n          version: VERSION,\n          sha256Hash: getQueryHash(query)\n        };\n      } catch (e) {\n        hashError = e;\n      }\n    }\n\n    return new Observable(function (observer) {\n      if (hashError) {\n        observer.error(hashError);\n        return;\n      }\n\n      var subscription;\n      var retried = false;\n      var originalFetchOptions;\n      var setFetchOptions = false;\n\n      var retry = function retry(_a, cb) {\n        var response = _a.response,\n            networkError = _a.networkError;\n\n        if (!retried && (response && response.errors || networkError)) {\n          retried = true;\n          supportsPersistedQueries = !disable({\n            response: response,\n            networkError: networkError,\n            operation: operation,\n            graphQLErrors: response && response.errors || void 0\n          });\n\n          if (response && response.errors && response.errors.some(function (_a) {\n            var message = _a.message;\n            return message === 'PersistedQueryNotFound';\n          }) || !supportsPersistedQueries) {\n            if (subscription) subscription.unsubscribe();\n            operation.setContext({\n              http: {\n                includeQuery: true,\n                includeExtensions: supportsPersistedQueries\n              }\n            });\n\n            if (setFetchOptions) {\n              operation.setContext({\n                fetchOptions: originalFetchOptions\n              });\n            }\n\n            subscription = forward(operation).subscribe(handler);\n            return;\n          }\n        }\n\n        cb();\n      };\n\n      var handler = {\n        next: function next(response) {\n          retry({\n            response: response\n          }, function () {\n            return observer.next(response);\n          });\n        },\n        error: function error(networkError) {\n          retry({\n            networkError: networkError\n          }, function () {\n            return observer.error(networkError);\n          });\n        },\n        complete: observer.complete.bind(observer)\n      };\n      operation.setContext({\n        http: {\n          includeQuery: !supportsPersistedQueries,\n          includeExtensions: supportsPersistedQueries\n        }\n      });\n\n      if (useGETForHashedQueries && supportsPersistedQueries && operationIsQuery(operation)) {\n        operation.setContext(function (_a) {\n          var _b = _a.fetchOptions,\n              fetchOptions = _b === void 0 ? {} : _b;\n          originalFetchOptions = fetchOptions;\n          return {\n            fetchOptions: Object.assign({}, fetchOptions, {\n              method: 'GET'\n            })\n          };\n        });\n        setFetchOptions = true;\n      }\n\n      subscription = forward(operation).subscribe(handler);\n      return function () {\n        if (subscription) subscription.unsubscribe();\n      };\n    });\n  });\n};","map":{"version":3,"mappings":"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","names":["ApolloLink","Observable","sha256","require","print","VERSION","defaultGenerateHash","query","update","digest","defaultOptions","generateHash","disable","_a","graphQLErrors","operation","some","message","getContext","response","status","useGETForHashedQueries","definitionIsMutation","d","kind","operationIsQuery","definitions","Object","prototype","hasOwnProperty","hashesKeyString","hashesKey","Symbol","for","nextHashesChildKey","createPersistedQueryLink","options","assign","supportsPersistedQueries","hashesChildKey","getQueryHash","call","defineProperty","value","create","enumerable","hashes","forward","Error","hashError","extensions","persistedQuery","version","sha256Hash","e","observer","error","subscription","retried","originalFetchOptions","setFetchOptions","retry","cb","networkError","errors","unsubscribe","setContext","http","includeQuery","includeExtensions","fetchOptions","subscribe","handler","next","complete","bind","_b","method"],"sourceRoot":"","sources":["../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}